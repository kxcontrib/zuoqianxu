\l json.q
\d .h
ty[`htm]:"text/html;charset=gbk";
.z.ph:{X::x:uh$[@x;x;*x];$[~#x;hy[`htm]fram[$.z.f;x]("?";"?",*x:$."\\v");x~,"?";hp@{hb["?",x]x}'$."\\v";"?["~2#x;hp jx["J"$2_x]R;"?"=*x;@[{hp jx[0j]R::1_x};x;he];"="=*x;@[{hy[`htm]@. 1_x};x;he];"?"in x;@[{hy[t]@`/:tx[t:`$-3#n#x]@.(1+n:x?"?")_x};x;he];#r:@[1::;`$":",p:HOME,"/",x;""];hy[`$(1+x?".")_x]"c"$r;hn["404 Not Found";`txt]p,": not found"]};
ggimg:{[]html hta[`img](,`src)!,chart chartsize[150 200] charttype[`lc] axistype[`x`y] axislabel[(`mar`apr`may`jun`jul;``50Kb)] simpleencode[26?60] title["kdb+"] endchart};
jspkg:`ScatterChart`LineChart`BarChart`ColumnChart`PieChart`AreaChart`Table`MotionChart`AnnotatedTimeLine`Gauge`ImageChart`GeoMap`IntensityMap`Map`OrgChart`TreeMap!`corechart`corechart`corechart`corechart`corechart`corechart`table`motionchart`annotatedtimeline`gauge`imagechart`geomap`intensitymap`map`orgchart`treemap;
extpkg:`PilesOfMoney`BarsOfStuff`drasticdata.DrasticTreemap`Dygraph.GVizChart`org.systemsbiology.visualization.BioHeatMap`vizObj.ParallelC`greg.ross.visualisation.MagicTable!("http://visapi-gadgets.googlecode.com/svn/trunk/pilesofmoney/pom.js";"http://visapi-gadgets.googlecode.com/svn/trunk/barsofstuff/bos.js";"http://ep09.pld-linux.org/~mmazur/DrasticTreemapGApi/DrasticTreemapGApi.js";"http://danvk.org/dygraphs/dygraph-combined.js";"http://systemsbiology-visualizations.googlecode.com/svn/trunk/src/main/js/load.js";"http://parallel-coordinates.googlecode.com/svn/trunk/parallelC.js";"http://magic-table.googlecode.com/svn/trunk/magic-table/javascript/magic_table.js");
extcss:`PilesOfMoney`BarsOfStuff!("http://visapi-gadgets.googlecode.com/svn/trunk/pilesofmoney/pom.css";"http://visapi-gadgets.googlecode.com/svn/trunk/barsofstuff/bos.css");
extggjs:`drasticdata.DrasticTreemap`org.systemsbiology.visualization.BioHeatMap!("google.load('swfobject','2.2');";"google.load('prototype','1.6');");
extpkgjs:(,`org.systemsbiology.visualization.BioHeatMap)!,"systemsbiology.load('visualization','1.0',{packages:['bioheatmap']});";
/'string' 'number' 'boolean' 'date' 'datetime' 'timeofday'
ggdt:{[x;y]x:+x;.json.json `cols`rows!(((!x),'$[(11=@y`label)&#y`label;y`label;!x]){`id`label`type!($x[0];$x[1];y)}'$[(11=@y`ftype)&#y`ftype;y`ftype;{$[x=1h;`boolean;x=14h;`date;x=15h;`datetime;x within 5 9;`number;`string]}'@:'. x];{(,`c)!,{$[3=#x;`v`f`p!x;2=#x;`v`f!x;(,`v)!,x]}'x}'+. x)};
ggjs:{[x;y;z]p:extpkg x;htc[`html](htc[`head] $[#s:extcss x;hta[`link;`rel`type`href!("stylesheet";"text/css";s)];""],htac[`script;`type`src!("text/javascript";"http://www.google.com/jsapi");""],htac[`script;(,`type)!,"text/javascript";"google.load('visualization','1'",$[^jspkg[x];"";",{'packages':['",($jspkg[x]),"']}"],");",$[#j:extggjs x;j;""]],$[#p;htac[`script;`type`src!("text/javascript";p);""];""],htac[`script;(,`type)!,"text/javascript";$[#j:extpkgjs x;j;""],"google.setOnLoadCallback(draw);function draw(){var data = new google.visualization.DataTable(",(ggdt[y;z]),",0.1);var chart = new ",$[#p;$x;"google.visualization.",($x)],"(document.getElementById('chart'));chart.draw(data,",(.json.json `label`ftype`expkg`exload _ z),");}"]),htc[`body]htac[`div;(`id`style)!("chart";"width: 1100px; height: 500px;");""]};
ggjseg1:{[]ggjs[`PieChart;([]Task:(`Work`Eat`Commute`WatchTV`Sleep);Hours:(11;2;2;2;(7.5;"7.000")));`width`height`is3D`title`label`ftype!(800;600;1b;"日程";`$("任务";"时间");`string`number)]};
ggjseg2:{[]ggjs[`PieChart;([]Task:(`Work`Eat`Commute`WatchTV`Sleep);Hours:(11 2 2 2 7.5));`width`height`is3D`title!(800;600;1b;"日程")]};
ggjseg3:{[]ggjs[`LineChart;([]Year:("2004";"2005";"2006";"2007");Sales:(1000 1170 860 1030);Expenses:(400 460 580 540));`width`height`title!(800;600;"业绩")]};
ggjseg4:{[]ggjs[`ScatterChart;([]Age:8 4 11 4 3 6.5;Weight:12 5.5 14 4.5 3.5 7);`width`height`title!(800;600;"散点图例")]};
ggjseg5:{[]ggjs[`Table;([]Task:(`Work`Eat`Commute`WatchTV`Sleep);Hours:(11 2 2 2 7.5));`label`showRowNumber!(`$("任务";"时间");1b)]};
ggjseg6:{[]ggjs[`AreaChart;([]Year:("2004";"2005";"2006";"2007");Sales:(1000 1170 860 1030);Expenses:(400 460 580 540));`width`height`title!(800;600;"业绩")]};
ggjseg7:{[]ggjs[`BarChart;([]Year:("2004";"2005";"2006";"2007");Sales:(1000 1170 860 1030);Expenses:(400 460 580 540));`width`height`title!(800;600;"业绩")]};
ggjseg8:{[]ggjs[`ColumnChart;([]Year:("2004";"2005";"2006";"2007");Sales:(1000 1170 860 1030);Expenses:(400 460 580 540));`width`height`title!(800;600;"业绩")]};
ggjseg9:{[]ggjs[`Gauge;([]Label:("Memory";"CPU";"Network");Value:80 55 68);`width`height!(800;600)]};
ggjseg10:{[]ggjs[`MotionChart;([]Fruit:("Apples";"Oranges";"Bananas";"Apples";"Oranges";"Bananas");Date:1988.01.01 1988.01.01 1988.01.01 1989.07.01 1989.07.01 1989.07.01;Sales:1000 1150 300 1200 750 788;Expenses:300 200 250 400 150 617;Location:("East";"West";"West";"East";"West";"West"));`width`height!(800;600)]};
ggjseg11:{[]ggjs[`OrgChart;([]Name:(("Mike";"Mike<div style='color:red; font-style:italic'>President</div>");("Jim";"Jim<div style='color:red; font-style:italic'>Vice President</div>");"Alice";"Bob";"Carol");Manager:``Mike`Mike`Jim`Bob;ToolTip:("The President";" VP";"";"Bob Sponge";""));`width`height`allowHtml!(800;600;1b)]};
ggjseg12:{[]ggjs[`TreeMap;([]Region:`Global`America`Europe`Asia`Australia`Africa`Brazil`USA`Mexico`Canada`France`Germany`Sweden`Italy`UK`China`Japan`India`Laos`Mongolia`Israel`Iran`Pakistan`Egypt`S.Africa`Sudan`Congo`Zair;Parent:``Global`Global`Global`Global`Global`America`America`America`America`Europe`Europe`Europe`Europe`Europe`Asia`Asia`Asia`Asia`Asia`Asia`Asia`Asia`Africa`Africa`Africa`Africa`Africa;Volume:0 0 0 0 0 0 11 52 24 16 42 31 22 17 21 36 20 40 4 1 12 18 11 21 30 12 10 8;Delta:0 0 0 0 0 0 10 31 12 -23 -11 -2 -13 4 -5 4 -12 63 34 -5 24 13 -52 0 43 2 12 10);`minColor`midColor`maxColor`headerHeight`fontColor`showScale!("#f00";"#ddd";"#0d0";15;"black";1b)]};
ggjseg13:{[]ggjs[`AnnotatedTimeLine;([]Date:2008.02.01 2008.02.02 2008.02.03 2008.02.04 2008.02.05 2008.02.06;Pencils:30000 14045 55022 75284 41476 33322;title1:("";"";"";"";"Bought Pens";"");text1:("";"";"";"";"Bought 200k pens";"");Pens:40645 20374 50766 14334 66467 39463;title2:("";"";"";"Out of Stock";"";"");text2:("";"";"";"Ran out of stock on pens at 4pm";"";""));`width`height`displayAnnotations!(800;600;1b)]};
ggjseg14:{[]ggjs[`Dygraph.GVizChart;([]Date:2009.07.01 2009.07.08 2009.07.15 2009.07.22;Sales:(1000 1170 860 1030);Expenses:(400 460 580 540));()!()]};
ggjseg15:{[]ggjs[`drasticdata.DrasticTreemap;([]Product:`Greenbeans`Avocado`Tomatos`Cucumbers`Apples`Bananas`Oranges`Pineapples`Broccoli`Wholemeal`Bagels`Baguette`Ciabatta`Croissants`whitebread;Type:`Vegetables`Vegetables`Vegetables`Vegetables`Fruit`Fruit`Fruit`Fruit`Vegetables`Bread`Bread`Bread`Bread`Bread`Bread;East:100 50 200 500 1700 800 200 100 800 250 120 50 200 400 500;West:100 400 400 1000 2300 700 300 150 1000 100 300 300 300 600 200;South:400 300 500 700 2000 600 100 500 900 300 200 200 400 200 300);`groupbycol`labelcol`variables!(`Type;`Product;`East`West`South)]};
ggjseg16:{[]ggjs[`BarsOfStuff;([]Label:`France`Sweden`USA`Poland;Value:10000 30000 20000 7500);`width`height`title!(800;600;"业绩")]};
ggjseg17:{[]ggjs[`org.systemsbiology.visualization.BioHeatMap;([]GeneName:`ATF3`INS`TAP1`IL6;chip1:0 3 0 -3;chip2:0.5 3.5 0n -3.5;chip3:1 4 -1 -4;chip4:1.5 4.5 -1.5 -4.5;chip5:2 5 -2 -5;chip6:2.5 5.5 -2.5 -5.5);`width`height`title!(800;600;"业绩")]};
ggjseg18:{[]ggjs[`PilesOfMoney;([]Label:`France`Sweden`USA`Poland;Value:10000 30000 20000 7500);`width`height`title!(800;600;"业绩")]};
ggjseg19:{[]ggjs[`vizObj.ParallelC;([]MPG:18 15 27 26 25;Cylinders:8 8 4 4 4;HorsePower:130 165 88 46 87;Weight:3504 3693 2130 1835 2672;Acceleration:12 11.5 14.5 20.5 17.5;Origin:`USA`USA`Europe`Japan`Japan);`width`height`title!(800;600;"汽车数据")]};
ggjseg20:{[]ggjs[`greg.ross.visualisation.MagicTable;([]c1:10?10f;c2:10?10f;c3:10?10f;c4:10?10f;c5:10?10f);`tableTitle`enableFisheye`enableBarFill`defaultRowHeight`columnWidths`defaultColumnWidth`rowHeaderCount`columnHeaderCount`tablePositionX`tablePositionY`tableHeight`tableWidth`colourRamp!("Bar-fill";1b;1b;25;,`column`width!0 130;60;0;0;0;0;403;315;+`red`green`blue!(0 0 0 255 255;0 255 255 255 0;255 255 0 0 0))]};
ggjseg21:{[]ggjs[`ImageChart;([]c1:0 5 10 7 12 6;c2:35 25 45 47 24 46;c3:15 40 30 27 39 54;c4:0 55 63 59 80 60);`cht`chm`firstHiddenColumn!(`lc;"F,0000FF,0,,20";0)]};
ggjseg22:{[]ggjs[`ImageChart;([]c1:100 80 60 30 25 20 10;c2:10 20 30 40 50 60 70);`cht`chco`chg`chm!(`rs;"00FF00,FF00FF";"25.0,25.0,4.0,4.0";"B,FF000080,0,1.0,5.0|B,FF990080,1,1.0,5.0")]};
\d .